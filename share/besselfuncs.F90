!  Created 2013/10/29 NCAR
!
!-----------------------------
MODULE BESSELFUNCS

 IMPLICIT NONE
 PRIVATE

 PUBLIC DBESJ0

 CONTAINS
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

  FUNCTION DBESJ0( x ) RESULT(  rj0 )
! Bessel J_0(x) function in double precision
!
  real, intent(IN) ::  x
  REAL :: rj0
  real(kind=8)  :: dj0, v, w, t, y , theta, a(0 : 7), b(0 : 64), c(0 : 69), d(0 : 51)
  integer :: i,k

  real, parameter :: pi4 = 0.78539816339744830962d0

        data (a(i), i = 0, 7) /  &
         -0.0000000000023655394d0, 0.0000000004708898680d0, &
         -0.0000000678167892231d0, 0.0000067816840038636d0, &
         -0.0004340277777716935d0, 0.0156249999999992397d0, &
         -0.2499999999999999638d0, 0.9999999999999999997d0 / 
      data (b(i), i = 0, 12) / &
         0.0000000000626681117d0, -0.0000000022270614428d0, &
         0.0000000662981656302d0, -0.0000016268486502196d0, &
         0.0000321978384111685d0, -0.0005005237733315830d0, &
         0.0059060313537449816d0, -0.0505265323740109701d0, &
         0.2936432097610503985d0, -1.0482565081091638637d0, &
         1.9181123286040428113d0, -1.1319199475221700100d0, &
         -0.1965480952704682000d0 / 
      data (b(i), i = 13, 25) / &
         0.0000000000457457332d0, -0.0000000015814772025d0, &
         0.0000000455487446311d0, -0.0000010735201286233d0, &
         0.0000202015179970014d0, -0.0002942392368203808d0, &
         0.0031801987726150648d0, -0.0239875209742846362d0, &
         0.1141447698973777641d0, -0.2766726722823530233d0, &
         0.1088620480970941648d0, 0.5136514645381999197d0, &
         -0.2100594022073706033d0 / 
      data (b(i), i = 26, 38) / &
         0.0000000000331366618d0, -0.0000000011119090229d0, &
         0.0000000308823040363d0, -0.0000006956602653104d0, &
         0.0000123499947481762d0, -0.0001662951945396180d0, &
         0.0016048663165678412d0, -0.0100785479932760966d0, &
         0.0328996815223415274d0, -0.0056168761733860688d0, &
         -0.2341096400274429386d0, 0.2551729256776404262d0, &
         0.2288438186148935667d0 / 
      data (b(i), i = 39, 51) / &
         0.0000000000238007203d0, -0.0000000007731046439d0, &
         0.0000000206237001152d0, -0.0000004412291442285d0, &
         0.0000073107766249655d0, -0.0000891749801028666d0, &
         0.0007341654513841350d0, -0.0033303085445352071d0, &
         0.0015425853045205717d0, 0.0521100583113136379d0, &
         -0.1334447768979217815d0, -0.1401330292364750968d0, & 
         0.2685616168804818919d0 / 
      data (b(i), i = 52, 64) / &
         0.0000000000169355950d0, -0.0000000005308092192d0, &
         0.0000000135323005576d0, -0.0000002726650587978d0, &
         0.0000041513240141760d0, -0.0000443353052220157d0, &
         0.0002815740758993879d0, -0.0004393235121629007d0, &
         -0.0067573531105799347d0, 0.0369141914660130814d0, &
         0.0081673361942996237d0, -0.2573381285898881860d0, &
         0.0459580257102978932d0 / 
      data (c(i), i = 0, 13) / &
         -0.00000000003009451757d0, -0.00000000014958003844d0, & 
         0.00000000506854544776d0, 0.00000001863564222012d0, &
         -0.00000060304249068078d0, -0.00000147686259937403d0, &
         0.00004714331342682714d0, 0.00006286305481740818d0, &
         -0.00214137170594124344d0, -0.00089157336676889788d0, & 
         0.04508258728666024989d0, -0.00490362805828762224d0, &
         -0.27312196367405374426d0, 0.04193925184293450356d0 / 
      data (c(i), i = 14, 27) / &
         -0.00000000000712453560d0, -0.00000000041170814825d0, &
         0.00000000138012624364d0, 0.00000005704447670683d0, &
         -0.00000019026363528842d0, -0.00000533925032409729d0, & 
         0.00001736064885538091d0, 0.00030692619152608375d0, &
         -0.00092598938200644367d0, -0.00917934265960017663d0, & 
         0.02287952522866389076d0, 0.10545197546252853195d0, &
         -0.16126443075752985095d0, -0.19392874768742235538d0 / 
      data (c(i), i = 28, 41) / &
         0.00000000002128344556d0, -0.00000000031053910272d0, &
         -0.00000000334979293158d0, 0.00000004507232895050d0, &
         0.00000036437959146427d0, -0.00000446421436266678d0, &
         -0.00002523429344576552d0, 0.00027519882931758163d0, &
         0.00097185076358599358d0, -0.00898326746345390692d0, &
         -0.01665959196063987584d0, 0.11456933464891967814d0, &
         0.07885001422733148815d0, -0.23664819446234712621d0 / 
      data (c(i), i = 42, 55) / &
         0.00000000003035295055d0, 0.00000000005486066835d0, &
         -0.00000000501026824811d0, -0.00000000501246847860d0, & 
         0.00000058012340163034d0, 0.00000016788922416169d0, &
         -0.00004373270270147275d0, 0.00001183898532719802d0, &
         0.00189863342862291449d0, -0.00113759249561636130d0, &
         -0.03846797195329871681d0, 0.02389746880951420335d0, &
         0.22837862066532347461d0, -0.06765394811166522844d0 / 
      data (c(i), i = 56, 69) / &
         0.00000000001279875977d0, 0.00000000035925958103d0, &
         -0.00000000228037105967d0, -0.00000004852770517176d0, & 
         0.00000028696428000189d0, 0.00000440131125178642d0, &
         -0.00002366617753349105d0, -0.00024412456252884129d0, &
         0.00113028178539430542d0, 0.00708470513919789080d0, &
         -0.02526914792327618386d0, -0.08006137953480093426d0, & 
         0.16548380461475971846d0, 0.14688405470042110229d0 / 
      data (d(i), i = 0, 12) / &
         1.059601355592185731d-14, -2.71150591218550377d-13, &
         8.6514809056201638d-12, -4.6264028554286627d-10, &
         5.0815403835647104d-8, -1.76722552048141208d-5, &
         0.16286750396763997378d0, 2.949651820598278873d-13, & 
         -8.818215611676125741d-12, 3.571119876162253451d-10, &
         -2.631924120993717060d-8, 4.709502795656698909d-6, &
         -5.208333333333283282d-3 / 
      data (d(i), i = 13, 25) / &
         7.18344107717531977d-15, -2.51623725588410308d-13, &
         8.6017784918920604d-12, -4.6256876614290359d-10, &
         5.0815343220437937d-8, -1.76722551764941970d-5, &
         0.16286750396763433767d0, 2.2327570859680094777d-13, & 
         -8.464594853517051292d-12, 3.563766464349055183d-10, &
         -2.631843986737892965d-8, 4.709502342288659410d-6, &
         -5.2083333332278466225d-3 / 
      data (d(i), i = 26, 38) / &
         5.15413392842889366d-15, -2.27740238380640162d-13, &
         8.4827767197609014d-12, -4.6224753682737618d-10, &
         5.0814848128929134d-8, -1.76722547638767480d-5, &
         0.16286750396748926663d0, 1.7316195320192170887d-13, & 
         -7.971122772293919646d-12, 3.544039469911895749d-10, &
         -2.631443902081701081d-8, 4.709498228695400603d-6, &
         -5.2083333315143653610d-3 / 
      data (d(i), i = 39, 51) / &
         3.84653681453798517d-15, -2.04464520778789011d-13, &
         8.3089298605177838d-12, -4.6155016158412096d-10, &
         5.0813263696466650d-8, -1.76722528311426167d-5, &
         0.16286750396650065930d0, 1.3797879972460878797d-13, & 
         -7.448089381011684812d-12, 3.512733797106959780d-10, &
         -2.630500895563592722d-8, 4.709483934775839193d-6, &
         -5.2083333227940760113d-3 / 
 

      w = abs(x)
      if (w .lt. 1) then
          t = w * w
          y = ((((((a(0) * t + a(1)) * t +  &
             a(2)) * t + a(3)) * t + a(4)) * t + &
             a(5)) * t + a(6)) * t + a(7)
      else if (w .lt. 8.5d0) then
          t = w * w * 0.0625d0
          k = int(t)
          t = t - (k + 0.5d0)
          k = k * 13
          y = (((((((((((b(k) * t + b(k + 1)) * t + &
             b(k + 2)) * t + b(k + 3)) * t + b(k + 4)) * t + &
             b(k + 5)) * t + b(k + 6)) * t + b(k + 7)) * t + &
             b(k + 8)) * t + b(k + 9)) * t + b(k + 10)) * t + &
             b(k + 11)) * t + b(k + 12)
      else if (w .lt. 12.5d0) then
          k = int(w)
          t = w - (k + 0.5d0)
          k = 14 * (k - 8)
          y = ((((((((((((c(k) * t + c(k + 1)) * t + &
             c(k + 2)) * t + c(k + 3)) * t + c(k + 4)) * t + &
             c(k + 5)) * t + c(k + 6)) * t + c(k + 7)) * t + &
             c(k + 8)) * t + c(k + 9)) * t + c(k + 10)) * t + &
             c(k + 11)) * t + c(k + 12)) * t + c(k + 13)
      else
          v = 24 / w
          t = v * v
          k = 13 * (int(t))
          y = ((((((d(k) * t + d(k + 1)) * t + &
             d(k + 2)) * t + d(k + 3)) * t + d(k + 4)) * t + &
             d(k + 5)) * t + d(k + 6)) * sqrt(v)
          theta = (((((d(k + 7) * t + d(k + 8)) * t + &
             d(k + 9)) * t + d(k + 10)) * t + d(k + 11)) * t + &
             d(k + 12)) * v - pi4
          y = y * cos(w + theta)
      end if

      rj0 = y

end function DBESJ0
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



  FUNCTION DBESJ1( x ) RESULT(  rj1 )
! Bessel J_0(x) function in double precision
!
  real, intent(IN) ::  x
  REAL :: rj1
  real(kind=8)  :: dj0, v, w, t, y , theta, a(0 : 7), b(0 : 64), c(0 : 69), d(0 : 51)
  integer :: k

  real, parameter :: pi4 = 0.78539816339744830962d0

#if 0
      data (a(i), i = 0, 7) / 
     &    -0.00000000000014810349d0, 0.00000000003363594618d0, 
     &    -0.00000000565140051697d0, 0.00000067816840144764d0, 
     &    -0.00005425347222188379d0, 0.00260416666666662438d0, 
     &    -0.06249999999999999799d0, 0.49999999999999999998d0 / 
      data (b(i), i = 0, 12) / 
     &    0.00000000000243721316d0, -0.00000000009400554763d0, 
     &    0.00000000306053389980d0, -0.00000008287270492518d0, 
     &    0.00000183020515991344d0, -0.00003219783841164382d0, 
     &    0.00043795830161515318d0, -0.00442952351530868999d0, 
     &    0.03157908273375945955d0, -0.14682160488052520107d0, 
     &    0.39309619054093640008d0, -0.47952808215101070280d0, 
     &    0.14148999344027125140d0 / 
      data (b(i), i = 13, 25) / 
     &    0.00000000000182119257d0, -0.00000000006862117678d0, 
     &    0.00000000217327908360d0, -0.00000005693592917820d0, 
     &    0.00000120771046483277d0, -0.00002020151799736374d0, 
     &    0.00025745933218048448d0, -0.00238514907946126334d0, 
     &    0.01499220060892984289d0, -0.05707238494868888345d0, 
     &    0.10375225210588234727d0, -0.02721551202427354117d0, 
     &    -0.06420643306727498985d0 / 
      data (b(i), i = 26, 38) / 
     &    0.000000000001352611196d0, -0.000000000049706947875d0, 
     &    0.000000001527944986332d0, -0.000000038602878823401d0, 
     &    0.000000782618036237845d0, -0.000012349994748451100d0, 
     &    0.000145508295194426686d0, -0.001203649737425854162d0, 
     &    0.006299092495799005109d0, -0.016449840761170764763d0, 
     &    0.002106328565019748701d0, 0.058527410006860734650d0, 
     &    -0.031896615709705053191d0 / 
      data (b(i), i = 39, 51) / 
     &    0.000000000000997982124d0, -0.000000000035702556073d0, 
     &    0.000000001062332772617d0, -0.000000025779624221725d0, 
     &    0.000000496382962683556d0, -0.000007310776625173004d0, 
     &    0.000078028107569541842d0, -0.000550624088538081113d0, 
     &    0.002081442840335570371d0, -0.000771292652260286633d0, 
     &    -0.019541271866742634199d0, 0.033361194224480445382d0, 
     &    0.017516628654559387164d0 / 
      data (b(i), i = 52, 64) / 
     &    0.000000000000731050661d0, -0.000000000025404499912d0, 
     &    0.000000000729360079088d0, -0.000000016915375004937d0, 
     &    0.000000306748319652546d0, -0.000004151324014331739d0, 
     &    0.000038793392054271497d0, -0.000211180556924525773d0, 
     &    0.000274577195102593786d0, 0.003378676555289966782d0, 
     &    -0.013842821799754920148d0, -0.002041834048574905921d0, 
     &    0.032167266073736023299d0 / 
      data (c(i), i = 0, 13) / 
     &    -0.00000000001185964494d0, 0.00000000039110295657d0, 
     &    0.00000000180385519493d0, -0.00000005575391345723d0, 
     &    -0.00000018635897017174d0, 0.00000542738239401869d0, 
     &    0.00001181490114244279d0, -0.00033000319398521070d0, 
     &    -0.00037717832892725053d0, 0.01070685852970608288d0, 
     &    0.00356629346707622489d0, -0.13524776185998074716d0, 
     &    0.00980725611657523952d0, 0.27312196367405374425d0 / 
      data (c(i), i = 14, 27) / 
     &    -0.00000000003029591097d0, 0.00000000009259293559d0, 
     &    0.00000000496321971223d0, -0.00000001518137078639d0, 
     &    -0.00000057045127595547d0, 0.00000171237271302072d0, 
     &    0.00004271400348035384d0, -0.00012152454198713258d0, 
     &    -0.00184155714921474963d0, 0.00462994691003219055d0, 
     &    0.03671737063840232452d0, -0.06863857568599167175d0, 
     &    -0.21090395092505707655d0, 0.16126443075752985095d0 / 
      data (c(i), i = 28, 41) / 
     &    -0.00000000002197602080d0, -0.00000000027659100729d0, 
     &    0.00000000374295124827d0, 0.00000003684765777023d0, 
     &    -0.00000045072801091574d0, -0.00000327941630669276d0, 
     &    0.00003571371554516300d0, 0.00017664005411843533d0, 
     &    -0.00165119297594774104d0, -0.00485925381792986774d0, 
     &    0.03593306985381680131d0, 0.04997877588191962563d0, 
     &    -0.22913866929783936544d0, -0.07885001422733148814d0 / 
      data (c(i), i = 42, 55) / 
     &    0.00000000000516292316d0, -0.00000000039445956763d0, 
     &    -0.00000000066220021263d0, 0.00000005511286218639d0, 
     &    0.00000005012579400780d0, -0.00000522111059203425d0, 
     &    -0.00000134311394455105d0, 0.00030612891890766805d0, 
     &    -0.00007103391195326182d0, -0.00949316714311443491d0, 
     &    0.00455036998246516948d0, 0.11540391585989614784d0, 
     &    -0.04779493761902840455d0, -0.22837862066532347460d0 / 
      data (c(i), i = 56, 69) / 
     &    0.00000000002697817493d0, -0.00000000016633326949d0, 
     &    -0.00000000433134860350d0, 0.00000002508404686362d0, 
     &    0.00000048528284780984d0, -0.00000258267851112118d0, 
     &    -0.00003521049080466759d0, 0.00016566324273339952d0, 
     &    0.00146474737522491617d0, -0.00565140892697147306d0, 
     &    -0.02833882055679300400d0, 0.07580744376982855057d0, 
     &    0.16012275906960187978d0, -0.16548380461475971845d0 / 
      data (d(i), i = 0, 12) / 
     &    -1.272346002224188092d-14, 3.370464692346669075d-13, 
     &    -1.144940314335484869d-11, 6.863141561083429745d-10, 
     &    -9.491933932960924159d-8, 5.301676561445687562d-5, 
     &    0.1628675039676399740d0, -3.652982212914147794d-13, 
     &    1.151126750560028914d-11, -5.165585095674343486d-10, 
     &    4.657991250060549892d-8, -1.186794704692706504d-5, 
     &    1.562499999999994026d-2 / 
      data (d(i), i = 13, 25) / 
     &    -8.713069680903981555d-15, 3.140780373478474935d-13, 
     &    -1.139089186076256597d-11, 6.862299023338785566d-10, 
     &    -9.491926788274594674d-8, 5.301676558106268323d-5, 
     &    0.1628675039676466220d0, -2.792555727162752006d-13, 
     &    1.108650207651756807d-11, -5.156745588549830981d-10, 
     &    4.657894859077370979d-8, -1.186794650130550256d-5, 
     &    1.562499999987299901d-2 / 
      data (d(i), i = 26, 38) / 
     &    -6.304859171204770696d-15, 2.857249044208791652d-13, 
     &    -1.124956921556753188d-11, 6.858482894906716661d-10, 
     &    -9.491867953516898460d-8, 5.301676509057781574d-5, 
     &    0.1628675039678191167d0, -2.185193490132496053d-13, 
     &    1.048820673697426074d-11, -5.132819367467680132d-10, 
     &    4.657409437372994220d-8, -1.186794150862988921d-5, 
     &    1.562499999779270706d-2 / 
      data (d(i), i = 39, 51) / 
     &    -4.740417209792009850d-15, 2.578715253644144182d-13, 
     &    -1.104148898414138857d-11, 6.850134201626289183d-10, 
     &    -9.491678234174919640d-8, 5.301676277588728159d-5, 
     &    0.1628675039690033136d0, -1.755122057493842290d-13, 
     &    9.848723331445182397d-12, -5.094535425482245697d-10, 
     &    4.656255982268609304d-8, -1.186792402114394891d-5, 
     &    1.562499998712198636d-2 / 
      w = abs(x)
      if (w .lt. 1) then
          t = w * w
          y = (((((((a(0) * t + a(1)) * t + 
     &        a(2)) * t + a(3)) * t + a(4)) * t + 
     &        a(5)) * t + a(6)) * t + a(7)) * w
      else if (w .lt. 8.5d0) then
          t = w * w * 0.0625d0
          k = int(t)
          t = t - (k + 0.5d0)
          k = k * 13
          y = ((((((((((((b(k) * t + b(k + 1)) * t + 
     &        b(k + 2)) * t + b(k + 3)) * t + b(k + 4)) * t + 
     &        b(k + 5)) * t + b(k + 6)) * t + b(k + 7)) * t + 
     &        b(k + 8)) * t + b(k + 9)) * t + b(k + 10)) * t + 
     &        b(k + 11)) * t + b(k + 12)) * w
      else if (w .lt. 12.5d0) then
          k = int(w)
          t = w - (k + 0.5d0)
          k = 14 * (k - 8)
          y = ((((((((((((c(k) * t + c(k + 1)) * t + 
     &        c(k + 2)) * t + c(k + 3)) * t + c(k + 4)) * t + 
     &        c(k + 5)) * t + c(k + 6)) * t + c(k + 7)) * t + 
     &        c(k + 8)) * t + c(k + 9)) * t + c(k + 10)) * t + 
     &        c(k + 11)) * t + c(k + 12)) * t + c(k + 13)
      else
          v = 24 / w
          t = v * v
          k = 13 * (int(t))
          y = ((((((d(k) * t + d(k + 1)) * t + 
     &        d(k + 2)) * t + d(k + 3)) * t + d(k + 4)) * t + 
     &        d(k + 5)) * t + d(k + 6)) * sqrt(v)
          theta = (((((d(k + 7) * t + d(k + 8)) * t + 
     &        d(k + 9)) * t + d(k + 10)) * t + d(k + 11)) * t + 
     &        d(k + 12)) * v - pi4
          y = y * sin(w + theta)
      end if
      if (x .lt. 0) y = -y
      rj1 = y
#endif


end FUNCTION DBESJ1



end MODULE BESSELFUNCS
